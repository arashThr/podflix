<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <title>Stripe Checkout Sample</title>
        <meta name="description" content="A demo of Stripe Payment Intents" />

        <link rel="icon" href="favicon.ico" type="image/x-icon" />
    </head>

    <body>
        <header class="sr-header">
            <div class="sr-header__logo"></div>
        </header>

        <div>
            <h1>Your payment succeeded</h1>
            <h4>
                View CheckoutSession response:
            </h4>
        </div>

        <div>
            <div class="sr-callout">
                <pre></pre>
            </div>
            <button onclick="window.location.href = '/';">Restart demo</button>
        </div>
        <script>
            var urlParams = new URLSearchParams(window.location.search)
            var sessionId = urlParams.get('session_id')
            if (sessionId) {
                fetch('/checkout-session?sessionId=' + sessionId)
                    .then(function(result) {
                        return result.json()
                    })
                    .then(function(session) {
                        var sessionJSON = JSON.stringify(session, null, 2)
                        document.querySelector('pre').textContent = sessionJSON
                    })
                    .catch(function(err) {
                        console.log('Error when fetching Checkout session', err)
                    })
            }
        </script>
    </body>
</html>
